<br><br>
<div class="ui container">
  <%= flash_messages %>
  <div class="ui grid">
    <div class="ten wide column">

      <h1 class="ui blue header">Home: <%= @home_team.name %></h1>
      <div class="ui five link cards">
        <% @home_team_players.each do |player| %>
          <div class="card">
            <a href="<%= player_path(player) %>"><div class="custom_img" style="background-image: url(<%= player.image_url_or_default %>);"></div></a>
            <div class="center aligned content">
              <div class="header">
                <%= player.full_name  %>
              </div>
            </div>
          </div>
        <% end %>
      </div>

      <% if @match.is_start %>
        <%= render 'away', away_team: @away_team, away_team_players: @away_team_players %>
      <% else %>
        <% if @match.team_owner_id == current_player.team_owner.team_id %>
          <div id="away-team">
            <h1 class="ui header">Free Teams</h1>
            <div class="ui list">
              <% @teams.each do |team| %>
                <div class="item">
                  <i class="soccer middle aligned icon"></i>
                  <div class="content">
                    <%= link_to team.name, team_path(id: team.id) %>
                    <%= link_to 'Invite', invite_match_requests_path(match_id: @match, team_id: team), class: 'ui green mini button' %>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
          <h1 class="ui header">Pending Requests</h1>
          <div class="ui three cards">
            <% @pending_requests.each do |request| %>
              <div class="ui card">
                <div class="content">
                  <div class="header"><%= Team.find(request.team_id).name %></div>
                </div>
                <div class="ui two buttons">
                  <%= link_to 'Accept', accept_match_request_path(request, match_id: @match), class: 'ui green attached button' %>
                  <%= link_to 'Decline', decline_match_request_path(request, match_id: @match), class: 'ui red attached button' %>
                </div>
              </div>
            <% end %>
          </div>
        <% end %>
      <% end %>
    </div>

    <div class="six wide column">
      <h1 class="ui header">Match Information</h1>
      <div class="ui list">
        <div class="item">
          <i class="marker icon"></i>
          <div class="content">
            <strong>District:</strong>
            <%= @match.venue_name %>
          </div>
        </div>
      </div>

      <% if @match.team_owner_id == current_player.team_owner.team_id %>
        <div class="ui basic center aligned segment">
          <%= link_to 'Select Field', select_match_path(@match), class: 'ui massive green button' %>
        </div>
      <% else %>
        <div class="ui basic center aligned segment">
          <%= link_to 'View', match_path(@match), class: 'ui massive blue button' %>
        </div>
      <% end %>

      <h1 class="ui header">Match Discussion</h1>

      <%= form_for [@match, MatchMessage.new], remote: true do |f| %>
        <div class="ui large form">
          <div class="fields">
            <%= f.text_field :body, placeholder: 'New message', required: true %>
            <%= f.submit 'Send', class: 'ui large green button' %>
          </div>
        </div>
      <% end %>

      <div class="match-messages ui basic segment">
        <%= render @match_messages %>
      </div>
    </div>
  </div>
</div>

<script>
  function reload() {
    $.get("<%= match_match_messages_path(@match, format: :js) %>", function(response) {
      console.log("Reload successfully", response)
    });
  }

  setInterval(reload, 3000);
</script>