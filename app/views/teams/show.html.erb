<br><br>
<div class="ui container">
  <%= flash_messages %>
  <div class="ui grid">
    <div class="ui row">
      <div class="five wide column">
        <h1 class="ui header">
          Team
        </h1>

        <div class="ui card">
          <%= image_tag("default_club_logo.png", class: "ui rounded image") %><br>

          <div class="content">
            <div class="header">
              <strong class="red-color"><h3><%= @team.name %></strong>

              <a class="ui circular blue label">
                <%= @team.points %> pts
              </a>
            </div><br>

            <div class="description">
              <p>
                Founded in <%= @team.created_at.strftime("%Y") %>
              </p>
              <p><a class="ui red circular label">C</a>
                <%= link_to player_path(@team.team_owner.player) do %>
                  <strong class="blue-color"><%= @team.team_owner.player.full_name %></strong>
                <% end %>
              </p>
              <p>
                Matches played: <%= @number_of_matches %>
              </p>
            </div>
          </div>
        </div>

        <% if current_player.id == @team_owner.player_id %>
          <h1 class="ui header">
            Join Requests
          </h1>

          <div class="ui basic segment team-request-segment" >
            <div class="ui one link cards">
              <% @player_requests.each do |player_request| %>
                <% player = player_request.player %>
                <div class="ui link card">
                  <div class="ui basic segment card-segment-small">
                    <%= link_to player_path(player) do %>
                      <%= image_tag(player.image_url_or_default,
                          class: "ui rounded centered card-image image") %>
                    <% end %>
                  </div>

                  <div class="center aligned content">
                    <div class="ui small header">
                      <%= link_to player.full_name, player_path(player), class: "black-color" %>
                    </div>
                  </div>

                  <div class="extra content">
                    <div class="ui two buttons">
                      <%= link_to "Accept",
                          accept_team_request_path(player_id: player.id),
                                                   :method => :delete, class: 'ui green button' %>
                      <%= link_to "Decline",
                          decline_team_request_path(player_id: player.id),
                                                    :method => :delete, class: 'ui red button' %>
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>

    <div class="eleven wide column">
      <% if current_player.team_id == @team.id %>
        <h1 class="ui header">
          Team Discussion
        </h1>

        <div class="ui segment">
          <%= form_for [@team, TeamMessage.new()], remote: true do |f| %>
            <div class="ui form">
              <div class="fields">
                <%= f.text_field :body, placeholder: "Your message" %><br>
                <%= f.submit "Send", class: "ui green right floated button" %>
              </div>
            </div>
          <% end %>

          <div class="ui basic segment team-discussion-segment">
            <%= render @team_messages %>
          </div>
        </div>

      <% end %>

      <h1 class="ui header">
        Members
      </h1>

      <div class="ui basic segment team-member-segment" >
        <div class="ui five cards">
          <% @players.each do |player| %>
            <div class="ui card " id="card-bg">
              <%= image_tag(player.image_url_or_default,
                  class: "ui card-image image") %>
              <div class="content">
                <div class="ui small header">
                  <%= link_to player.full_name, player_path(player), class: "red-color" %>
                </div>
              </div>
            </div>
          <% end %>
        </div>
      </div>

      <% if current_player.id == @team_owner.player_id %>
        <h1 class="ui header">
          Match Invites
        </h1>

        <div class="ui basic segment match-invite-segment">
          <div class="ui five link cards">
            <% @match_invites.each do |match_invite| %>
             <div class="ui card">
                <div class="content">
                  <div class="header"><%= Team.find(match_invite.team_received_id).name %></div>
                </div>
                <div class="ui two buttons">
                  <%= link_to 'Accept', accept_match_request_path(match_invite), class: 'ui green attached button' %>
                  <%= link_to 'Decline', decline_match_request_path(match_invite, team_id: @team.id), class: 'ui red attached button' %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>

    </div>
  </div>
</div>

<script type="text/javascript">
  function reload() {
    $.get("<%=  team_team_messages_path(@team, format: :js) %>", function(response) {
      console.log("Reload successfully", response)
    })
  }

  setInterval(reload, 3000);
</script>